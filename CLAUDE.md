# Basehold - Project Guidelines for Claude

## Project Overview

**Basehold** - браузерная Tower Defense игра с элементами Roguelike и Survival.

- **Движок:** Pixi.js v8.15.0 (2D WebGL)
- **Язык:** TypeScript ~5.9.3
- **Сборщик:** Vite v7.2.4
- **Платформы:** Yandex Games, itch.io, GitHub Pages, локальный запуск

## Project Structure

```
src/
├── main.ts              # Entry point (Pixi, SDK, Game init)
├── Game.ts              # Main game controller, game loop
├── GameConfig.ts        # Constants: enemies, buildings, waves, perks
├── Player.ts            # Player class (movement, shooting, HP, perks)
├── Enemy.ts             # Enemy types (basic, fast, tank, boss, shooter, kamikaze)
├── Building.ts          # Building object (HP, damage, energy)
├── BuildingSystem.ts    # Building placement, grid 40x40, energy management
├── Projectile.ts        # Projectiles (player and enemy)
├── Particle.ts          # Visual effects (explosions, shells, sparks)
├── DropItem.ts          # Drop items (resources, perks)
├── ResourceNode.ts      # Resource nodes on map
├── ResourceManager.ts   # Resources (metal, biomass, battery, energy)
├── WaveManager.ts       # Wave system, timers, patterns
├── UpgradeManager.ts    # Shop (research, upgrades)
├── PerkManager.ts       # Perk system (boss drops)
├── UIManager.ts         # UI (HUD, menus, buttons, info panels)
├── Camera.ts            # Camera (follow, shake, zoom)
├── LightingSystem.ts    # Day/night cycle, darkness, lights
├── MiniMap.ts           # Minimap
├── InputSystem.ts       # Input (keyboard, mouse, touch, joystick)
├── VirtualJoystick.ts   # Virtual joystick for mobile
├── SoundManager.ts      # Sounds (shots, explosions, UI)
├── Rock.ts              # Decorative rocks
├── FloatingText.ts      # Floating text (damage, resources)
├── WorldBoundary.ts     # World boundary (void damage)
├── ObjectPool.ts        # Object pooling (optimization)
├── Localization.ts      # Translations (RU, EN)
├── YandexSDK.ts         # Yandex Games integration
├── Icons.ts             # Icons and emoji
└── style.css            # Global styles (dark theme, mobile-first)
```

## Commands

```bash
npm install      # Install dependencies
npm run dev      # Development server (localhost:5173)
npm run build    # TypeScript check + Vite build
npm run preview  # Preview production build
```

## Code Standards

### TypeScript
- `const` and `let` only, no `var`
- Arrow functions for callbacks
- `async/await` over promise chains
- Always handle errors with try/catch
- Naming:
  - `camelCase` - variables, functions
  - `PascalCase` - classes
  - `UPPER_CASE` - constants

### CSS
- Dark theme (#242424 base)
- Mobile-first approach
- `overflow: hidden` - prevent scroll
- `touch-action: none` - disable browser gestures

## Architecture

### Game Loop
```typescript
app.ticker.add((ticker) => {
  // Update: player, enemies, buildings, particles
  // Collisions and logic
  // Render (automatic in Pixi)
})
```

### Resources
- **Metal** - mining from nodes or enemy drops
- **Biomass** - mining, needed for research
- **Energy** - generated by generators, consumed by weapons
- **Battery** - energy storage

### Wave System
- Wave starts every 40 seconds
- 30 seconds preparation before wave (skippable)
- Every 10 waves - boss (pauses wave timer)
- Special patterns on waves 5, 7, 15, 20

### Perk System
Boss kill drops "Data Core" -> perk selection:
- Double Shot
- Vampirism
- Faster Reload
- Shield Core
- Auto Repair

### Yandex Games Integration
- Leaderboard (maxWave)
- Ads (fullscreen and rewarded)
- Cloud saves + localStorage fallback
- Platform language (ru/en)
- LoadingAPI (gameReady())

## Git Workflow

### Commit Format
- `feat:` - new feature
- `fix:` - bug fix
- `refactor:` - code refactoring
- `docs:` - documentation
- `style:` - formatting
- `chore:` - maintenance

### Before Commit
1. Code works correctly
2. No syntax errors
3. `npm run build` passes
4. Remove debug code and unnecessary comments

## UI/UX Guidelines

### Mobile Support
- Virtual joystick for movement and aiming
- Touch-friendly button sizes (min 44x44px)
- Responsive layout for different screen sizes
- No hover-only interactions

### HUD Layout
- Top: resources, wave info, time
- Bottom: action buttons, build menu
- Corners: minimap, menu buttons
- Center: game canvas

### Performance
- Object pooling for projectiles and particles
- Grid-based collision detection
- Culling off-screen objects
- Minimize DOM updates

## Pre-Completion Checklist

- [ ] Plan created
- [ ] Code written and tested
- [ ] No errors (`npm run build` passes)
- [ ] Code meets project standards
- [ ] Files saved
- [ ] Commit message is meaningful

**CRITICAL:** ALWAYS run `npm run build` before reporting task completion. No exceptions.
